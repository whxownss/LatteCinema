<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="CsAdmin">
	
	<select id="getExqBoardList" resultType="ExqBoardDTO" parameterType="PageDTO">
		SELECT *, ROW_NUMBER() OVER (ORDER BY CREATE_DATE) AS RN
		  FROM EXQBOARD
   		 ORDER BY CREATE_DATE  DESC 
   		 LIMIT #{startRow}, #{pageSize}
	</select>
	<select id="exqBoardCount" resultType="int"> 
		SELECT COUNT(*) 
		  FROM EXQBOARD
	</select>
	
	<select id="getCenterBoardList" resultType="CenterBoardDTO" parameterType="PageDTO">
		SELECT *,
	       (SELECT C.CI_NAME
	          FROM CINEMA AS C
	         WHERE C.LO_IDX = CENTER.LO_IDX AND C.CI_IDX = CENTER.CI_IDX) AS 'CI_NAME',
       	 ROW_NUMBER() OVER (ORDER BY CENTER.CREATE_DATE) AS RN
	 	 FROM CENTERBOARD AS CENTER
		 ORDER BY CENTER.CREATE_DATE DESC
		 LIMIT #{startRow}, #{pageSize}	
	</select>
	<select id="centerBoardCount" resultType="int">
		SELECT COUNT(*) 
		  FROM CENTERBOARD
	</select>
	<select id="getCenterBoard" resultType="CenterBoardDTO" parameterType="map">
		 SELECT *,
		       (SELECT C.CI_NAME
		          FROM CINEMA AS C
		         WHERE C.LO_IDX = CENTER.LO_IDX AND C.CI_IDX = CENTER.CI_IDX) AS 'CI_NAME'
		  FROM CENTERBOARD AS CENTER
		 WHERE CREATE_USER = #{createUser} AND CREATE_DATE = #{createDate}
	</select>
	<update id="saveCenterContent" parameterType="centerBoardDTO">
		UPDATE CENTERBOARD 
		   SET CENTERSUBJECT = #{centerSubject}, CENTERCONTENT = #{centerContent}, UPDATE_USER = #{updateUser}, UPDATE_DATE = SYSDATE()
		 WHERE CREATE_USER = #{createUser} AND CREATE_DATE = #{createDate}
	</update>
	<delete id="deleteCenterContent" parameterType="centerBoardDTO">
		DELETE FROM CENTERBOARD
 		 WHERE CREATE_USER = #{createUser} AND CREATE_DATE = #{createDate}
	</delete>
	<select id="getRegionList" resultType="LocationDTO">
		SELECT * 
		  FROM LOCATION
	</select>
	<select id="getCinemaList" resultType="CinemaDTO" parameterType="String">
		SELECT CI_IDX,CI_NAME
		  FROM CINEMA
		 WHERE LO_IDX = #{loIdx};
	</select>
	<insert id="insertCenterWrite" parameterType="CenterBoardDTO">
		INSERT INTO CENTERBOARD (LO_IDX,CI_IDX,CENTERSUBJECT,CENTERCONTENT,CREATE_USER,CREATE_DATE,UPDATE_USER,UPDATE_DATE)
		VALUES
		(
		 #{loIdx}
		,#{ciIdx}
		,#{centerSubject}
		,#{centerContent}
		,#{createUser}
		,sysdate()
		,NULL
		,NULL
		)
	</insert>
</mapper>